{"ast":null,"code":"var _jsxFileName = \"/Users/citrounette/Documents/Projets/WCS_Project_2/paris-0320-project2-howToBeFat/src/components/RecipeSearch.js\";\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport DisplaySearchRecipes from './recipeSearch/DisplayResults/DisplaySearchRecipes';\nimport Form from './recipeSearch/Form/Form';\nimport './RecipeSearch.css';\n\nconst RecipeSearch = () => {\n  // API request and Result\n  const [numOfResult, setNumOfResult] = useState(0);\n  const [errorRequest, setErrorRequest] = useState(false);\n  const [recipes, setRecipes] = useState([]); // Datas from form\n\n  const [userIngredient1, setUserIngredient1] = useState('');\n  const [userIngredient2, setUserIngredient2] = useState('');\n  const [userIngredient3, setUserIngredient3] = useState('');\n  const [userExcludeIngredient1, setUserExcludeIngredient1] = useState('');\n  const [userExcludeIngredient2, setUserExcludeIngredient2] = useState('');\n  const [userExcludeIngredient3, setUserExcludeIngredient3] = useState('');\n  const [userCalories, setUserCalories] = useState(0);\n  const [userPreparationTime, setUserPreparationTime] = useState(0);\n  const [userDiets, setUserDiets] = useState('');\n  const [userIntolerables, setUserIntolerables] = useState({\n    \"peanut-free\": false,\n    \"tree-nut-free\": false,\n    \"alcohol-free\": false\n  }); // Display\n\n  const [displayContent, setDisplayContent] = useState('form'); // Generate a random number\n\n  const getRandomNumber = max => Math.floor(Math.random() * Math.floor(max)); //Define the range of search for the api request\n\n\n  const defineRangeNumber = nbResults => {\n    const rangewidth = 100;\n    const numberToRandom = getRandomNumber(Math.ceil(nbResults / rangewidth));\n    const max = numberToRandom * rangewidth + rangewidth > nbResults ? nbResults - 1 : numberToRandom * rangewidth + rangewidth;\n    const min = max - rangewidth < 0 ? 0 : max - rangewidth;\n    return `&from=${min}&to=${max}`;\n  }; // Add the optionnal searches to the url request in depend of the users selected options\n\n\n  const defineRequestUrl = nbResults => {\n    setNumOfResult(nbResults);\n    nbResults = nbResults > 100 ? 100 : nbResults;\n    const calories = userCalories > 0 ? `&calories=${userCalories}-10000` : '';\n    const preparationTime = userPreparationTime ? `&time=1-${userPreparationTime}` : '';\n    const ingredients = `${userIngredient1},${userIngredient2},${userIngredient3}`;\n    const excludes = `&excluded=${userExcludeIngredient1}&excluded=${userExcludeIngredient2}&excluded=${userExcludeIngredient3}`; // add only the intolerables if its values are true\n\n    const intolerables = Object.entries(userIntolerables).filter(intolerable => intolerable[1]).reduce((a, b) => a + `&health=${b[0]}`, '');\n    const rangeRequest = nbResults > 0 ? defineRangeNumber(nbResults) : ''; // url which will be send to the API request\n\n    return `https://api.edamam.com/search?q=${ingredients}${calories}${rangeRequest}${userDiets}${intolerables}${excludes}${preparationTime}&app_id=812f083c&app_key=57cd06930f1a1d5818380b512897cc58`;\n  }; // We verify if the number of results are define\n\n\n  const callApi = url => numOfResult === 0 ? getNumRecipes(url) : getApiDatas(url); // If the number of result is unknown, we go fetch it\n\n\n  const getNumRecipes = url => {\n    axios.get(url).then(res => {\n      res.data.count === 0 ? manageErrors(\"no recipe\") : getApiDatas(defineRequestUrl(res.data.count));\n    }).catch(e => manageErrors(\"errorRequest1\"));\n  }; // Else we fetch the datas\n\n\n  const getApiDatas = url => {\n    axios.get(url).then(res => {\n      setRecipes(res.data.hits);\n      setDisplayContent('recipes');\n    }).catch(e => manageErrors(\"errorRequest2\"));\n  }; // When the form is validate by the users\n\n\n  const submitForm = e => {\n    e.preventDefault();\n    !userIngredient1 ? manageErrors(\"no ingredient\") : callApi(defineRequestUrl(0));\n  }; // Error display selector\n\n\n  const manageErrors = error => {\n    switch (error) {\n      case \"no recipe\":\n        setErrorRequest(\"No recipe found, please modify your choices\");\n        break;\n\n      case \"errorRequest1\":\n        setErrorRequest(\"Error, please check your ingredients\");\n        break;\n\n      case \"errorRequest2\":\n        setErrorRequest(\"Too many requests, please try again in few seconds\");\n        break;\n\n      case \"no ingredient\":\n        setErrorRequest(\"You have to insert at minimum one ingredient to validate the form\");\n        break;\n\n      default:\n        setErrorRequest(\"Please contact the administrator\");\n        break;\n    }\n  }; // When an error occured, the errorRequest state re-initialized after 5 secondes\n\n\n  useEffect(() => {\n    setTimeout(() => setErrorRequest(false), 5000);\n  }, [errorRequest]); // Define the state depending of the form element\n\n  const handleChange = e => {\n    const value = e.target.value.toLowerCase();\n\n    switch (e.target.name) {\n      case \"ingredient1\":\n        setUserIngredient1(value);\n        break;\n\n      case \"ingredient2\":\n        setUserIngredient2(value);\n        break;\n\n      case \"ingredient3\":\n        setUserIngredient3(value);\n        break;\n\n      case \"excludedIngredient1\":\n        setUserExcludeIngredient1(value);\n        break;\n\n      case \"excludedIngredient2\":\n        setUserExcludeIngredient2(value);\n        break;\n\n      case \"excludedIngredient3\":\n        setUserExcludeIngredient3(value);\n        break;\n\n      case \"calories\":\n        setUserCalories(e.target.value);\n        break;\n\n      case \"time\":\n        setUserPreparationTime(e.target.value);\n        break;\n\n      case \"specialDiets\":\n        setUserDiets(`&health=${e.target.value}`);\n        break;\n\n      case \"intolerables\":\n        setUserIntolerables({ ...userIntolerables,\n          [value]: e.target.checked\n        });\n        break;\n\n      default:\n    }\n  };\n\n  const handleClick = () => {\n    setDisplayContent(\"form\");\n    setNumOfResult(0);\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"recipeSearch\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"mainTitle\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 7\n    }\n  }, \"CUSTOMIZE YOUR RECIPE\"),\n  /* Display of the form */\n  displayContent === \"form\" ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Form, {\n    handleChange: handleChange,\n    submitForm: submitForm,\n    userCalories: userCalories,\n    userPrepTime: userPreparationTime,\n    errorRequest: errorRequest,\n    numOfResult: numOfResult,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 13\n    }\n  })) : /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"newSearch\",\n    onClick: e => handleClick(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 13\n    }\n  }, \"New search\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"triangle\",\n    onClick: e => handleClick(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(DisplaySearchRecipes, {\n    recipes: recipes,\n    numOfResult: numOfResult - 1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 13\n    }\n  })));\n};\n\nexport default RecipeSearch;","map":{"version":3,"sources":["/Users/citrounette/Documents/Projets/WCS_Project_2/paris-0320-project2-howToBeFat/src/components/RecipeSearch.js"],"names":["React","useState","useEffect","axios","DisplaySearchRecipes","Form","RecipeSearch","numOfResult","setNumOfResult","errorRequest","setErrorRequest","recipes","setRecipes","userIngredient1","setUserIngredient1","userIngredient2","setUserIngredient2","userIngredient3","setUserIngredient3","userExcludeIngredient1","setUserExcludeIngredient1","userExcludeIngredient2","setUserExcludeIngredient2","userExcludeIngredient3","setUserExcludeIngredient3","userCalories","setUserCalories","userPreparationTime","setUserPreparationTime","userDiets","setUserDiets","userIntolerables","setUserIntolerables","displayContent","setDisplayContent","getRandomNumber","max","Math","floor","random","defineRangeNumber","nbResults","rangewidth","numberToRandom","ceil","min","defineRequestUrl","calories","preparationTime","ingredients","excludes","intolerables","Object","entries","filter","intolerable","reduce","a","b","rangeRequest","callApi","url","getNumRecipes","getApiDatas","get","then","res","data","count","manageErrors","catch","e","hits","submitForm","preventDefault","error","setTimeout","handleChange","value","target","toLowerCase","name","checked","handleClick"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport axios from 'axios'\n\nimport DisplaySearchRecipes from './recipeSearch/DisplayResults/DisplaySearchRecipes'\nimport Form from './recipeSearch/Form/Form'\n\nimport './RecipeSearch.css'\n\nconst RecipeSearch = () => {\n\n  // API request and Result\n  const [numOfResult, setNumOfResult] = useState(0)\n  const [errorRequest, setErrorRequest] = useState(false)\n  const [recipes, setRecipes] = useState([])\n  // Datas from form\n  const [userIngredient1, setUserIngredient1] = useState('')\n  const [userIngredient2, setUserIngredient2] = useState('')\n  const [userIngredient3, setUserIngredient3] = useState('')\n  const [userExcludeIngredient1, setUserExcludeIngredient1] = useState('')\n  const [userExcludeIngredient2, setUserExcludeIngredient2] = useState('')\n  const [userExcludeIngredient3, setUserExcludeIngredient3] = useState('')\n  const [userCalories, setUserCalories] = useState(0)\n  const [userPreparationTime, setUserPreparationTime] = useState(0)\n  const [userDiets, setUserDiets] = useState('')\n  const [userIntolerables, setUserIntolerables] =\n    useState({\n      \"peanut-free\": false,\n      \"tree-nut-free\": false,\n      \"alcohol-free\": false\n    })\n\n  // Display\n  const [displayContent, setDisplayContent] = useState('form')\n\n  // Generate a random number\n  const getRandomNumber = (max) => Math.floor(Math.random() * Math.floor(max))\n  //Define the range of search for the api request\n  const defineRangeNumber = (nbResults) => {\n    const rangewidth = 100\n    const numberToRandom = getRandomNumber(Math.ceil(nbResults / rangewidth))\n    const max = (numberToRandom * rangewidth) + rangewidth > nbResults ? nbResults - 1 : (numberToRandom * rangewidth) + rangewidth\n    const min = max - rangewidth < 0 ? 0 : max - rangewidth\n    return `&from=${min}&to=${max}`\n  }\n\n  // Add the optionnal searches to the url request in depend of the users selected options\n  const defineRequestUrl = (nbResults) => {\n    setNumOfResult(nbResults)\n    nbResults = nbResults > 100 ? 100 : nbResults\n    const calories = userCalories > 0 ? `&calories=${userCalories}-10000` : ''\n    const preparationTime = userPreparationTime ? `&time=1-${userPreparationTime}` : ''\n    const ingredients = `${userIngredient1},${userIngredient2},${userIngredient3}`\n    const excludes = `&excluded=${userExcludeIngredient1}&excluded=${userExcludeIngredient2}&excluded=${userExcludeIngredient3}`\n    // add only the intolerables if its values are true\n    const intolerables = Object.entries(userIntolerables)\n      .filter(intolerable => intolerable[1])\n      .reduce((a, b) => a + `&health=${b[0]}`, '')\n    const rangeRequest = nbResults > 0 ? defineRangeNumber(nbResults) : ''\n\n    // url which will be send to the API request\n    return `https://api.edamam.com/search?q=${ingredients}${calories}${rangeRequest}${userDiets}${intolerables}${excludes}${preparationTime}&app_id=812f083c&app_key=57cd06930f1a1d5818380b512897cc58`\n  }\n\n  // We verify if the number of results are define\n  const callApi = (url) => numOfResult === 0 ? getNumRecipes(url) : getApiDatas(url)\n  // If the number of result is unknown, we go fetch it\n  const getNumRecipes = (url) => {\n    axios.get(url)\n      .then((res) => {\n        res.data.count === 0 ?\n          manageErrors(\"no recipe\") :\n          getApiDatas(defineRequestUrl(res.data.count))\n      })\n      .catch(e => manageErrors(\"errorRequest1\"))\n  }\n  // Else we fetch the datas\n  const getApiDatas = (url) => {\n    axios.get(url)\n      .then(res => {\n        setRecipes(res.data.hits)\n        setDisplayContent('recipes')\n      })\n      .catch(e => manageErrors(\"errorRequest2\"))\n  }\n  // When the form is validate by the users\n  const submitForm = (e) => {\n    e.preventDefault()\n    !userIngredient1 ? manageErrors(\"no ingredient\")\n      : callApi(defineRequestUrl(0))\n  }\n  // Error display selector\n  const manageErrors = (error) => {\n    switch (error) {\n      case \"no recipe\":\n        setErrorRequest(\"No recipe found, please modify your choices\")\n        break\n      case \"errorRequest1\":\n        setErrorRequest(\"Error, please check your ingredients\")\n        break\n      case \"errorRequest2\":\n        setErrorRequest(\"Too many requests, please try again in few seconds\")\n        break\n      case \"no ingredient\":\n        setErrorRequest(\"You have to insert at minimum one ingredient to validate the form\")\n        break\n      default:\n        setErrorRequest(\"Please contact the administrator\")\n        break\n    }\n  }\n  // When an error occured, the errorRequest state re-initialized after 5 secondes\n  useEffect(() => {\n    setTimeout(() => setErrorRequest(false), 5000)\n  }, [errorRequest])\n\n  // Define the state depending of the form element\n  const handleChange = (e) => {\n    const value = e.target.value.toLowerCase()\n    switch (e.target.name) {\n      case \"ingredient1\":\n        setUserIngredient1(value)\n        break\n      case \"ingredient2\":\n        setUserIngredient2(value)\n        break\n      case \"ingredient3\":\n        setUserIngredient3(value)\n        break\n      case \"excludedIngredient1\":\n        setUserExcludeIngredient1(value)\n        break\n      case \"excludedIngredient2\":\n        setUserExcludeIngredient2(value)\n        break\n      case \"excludedIngredient3\":\n        setUserExcludeIngredient3(value)\n        break\n      case \"calories\":\n        setUserCalories(e.target.value)\n        break\n      case \"time\":\n        setUserPreparationTime(e.target.value)\n        break\n      case \"specialDiets\":\n        setUserDiets(`&health=${e.target.value}`)\n        break\n      case \"intolerables\":\n        setUserIntolerables({ ...userIntolerables, [value]: e.target.checked })\n        break\n      default:\n    }\n  }\n\n  const handleClick = () => {\n    setDisplayContent(\"form\")\n    setNumOfResult(0)\n  }\n\n  return (\n    <div className='recipeSearch'>\n      <h2 className=\"mainTitle\">CUSTOMIZE YOUR RECIPE</h2>\n      {/* Display of the form */\n        displayContent === \"form\" ?\n          <>\n            <Form handleChange={handleChange} submitForm={submitForm} userCalories={userCalories} userPrepTime={userPreparationTime} errorRequest={errorRequest}\n              numOfResult={numOfResult} />\n          </>\n          :\n          <>\n            <div className=\"newSearch\" onClick={(e) => handleClick(e)}>New search</div>\n            <div className=\"triangle\" onClick={(e) => handleClick(e)}></div>\n            <DisplaySearchRecipes recipes={recipes} numOfResult={numOfResult - 1} />\n          </>\n      }\n    </div>\n  )\n}\n\nexport default RecipeSearch"]},"metadata":{},"sourceType":"module"}